spss操作
=========

## 目录
* [spss操作](#spss操作)
	* [一、正态分布](#一正态分布)
		* [1、可信区间估计](#1可信区间估计)
		* [2、正态性检验](#2正态性检验)
	* [二、T检验](#二T检验)
		* [1、单样本T检验](#1单样本T检验)
		* [2、独立样本T检验](#2独立样本T检验)
		* [3、配对样本的T检验](#3配对样本的T检验)
    * [三、卡方检验](#三卡方检验)
        * [1、卡方检验](#1卡方检验)
        * [2、Fisher精确检验](#2Fisher精确检验)
        * [3、配对卡方检验](#3配对卡方检验)
        * [4、OR值计算](#4OR值计算)
        * [5、RR值计算](#5RR值计算)
        * [6、分层卡方检验](#6分层卡方检验)
    * [四、方差分析](#四方差分析)
        * [1、单因素方差分析](#1单因素方差分析)
        * [2、双因素方差分析](#2双因素方差分析)
        * [3、多因素方差分析](#3多因素方差分析)
    * [五、回归](#五回归)
        * [1、二分类Logistic回归](#1二分类Logistic回归)
        * [2、有序多分类Logistic回归](#2有序多分类Logistic回归)
        * [3、无序多分类Logistic回归](#3无序多分类Logistic回归)
        * [4、简单线性回归](#4简单线性回归)
        * [5、多重线性回归](#5多重线性回归)
### 一、正态分布
### 1、可信区间估计
为了解青少年龋齿的患病情况，某研究在当地随机抽取了800名青少年进行调查，经口腔医生检查后，共有200人患有龋齿，患病率为25.0%。试问当地青少年总体龋齿患病率的95%可信区间是多少？
- 在SPSS软件中录入数据如下：<br>
![图](/img/1/1-1.jpg)
- 发生情况中，发生龋齿录为1，未发生录为0；总样本均录为1；同时录入发生和未发生龋齿的人数
- 对发生人数进行加权：Data(数据)→Weight Cases(个案加权)，将人数放入Frequency Variable(频率变量)框中→ok(确定) 如下：<br>
![图](/img/1/1-2.jpg)
- 选择 Analyze(分析)→Descriptive Statistics(描述统计)→Ratio(比率) 如下：<br>
![图](/img/1/1-3.jpg)
- 将发生情况放入Numerator（分子）框中，总样本放入Denominator（分母）框中 如下：<br>
![图](/img/1/1-4.jpg)
- 点击Statistics(统计)，勾选Mean（平均值）和Confidence intervals，Level(%)：95（置信区间）即可→Continue（继续）→OK（确定）。 如下：<br>
![图](/img/1/1-5.jpg)
- 结果如下，用SPSS软件算出来的总体龋齿患病率的95%可信区间为（22.0%，28.0%）。 如下：<br>
![图](/img/1/1-6.jpg)
- 当样本率过高或过低，采用SPSS软件计算总体率的可信区间时，可能会出现可信区间的上限超过1或者下限低于0的情况。这是因为SPSS采用正态分布的方式来拟合二项分布，此时可以采用SAS软件进行总体率的区间估计。
### 2、正态性检验
当我们应用统计方法对数据进行分析时，会发现许多计量资料的分析方法，例如常用的T检验、方差分析、相关分析以及线性回归等等，都要求数据服从正态分布或者近似正态分布，但这一前提条件往往被使用者所忽略。因此为了保证数据满足上述统计方法的应用条件，对原始数据进行正态性检验是十分必要的
- 偏度（Skewness）：描述数据分布不对称的方向及其程度<br>
![图](/img/1/2-1.jpg)<br>
当偏度≈0时，可认为分布是对称的，服从正态分布；<br>
当偏度>0时，分布为右偏，即拖尾在右边，峰尖在左边，也称为正偏态；<br>
当偏度<0时，分布为左偏，即拖尾在左边，峰尖在右边，也称为负偏态；<br>
注意：数据分布的左偏或右偏，指的是数值拖尾的方向，而不是峰的位置，容易引起误解。
- 峰度（Kurtosis）：描述数据分布形态的陡缓程度<br>
![图](/img/1/2-2.jpg)<br>
当峰度≈0时，可认为分布的峰态合适，服从正态分布（不胖不瘦）；<br>
当峰度>0时，分布的峰态陡峭（高尖）；<br>
当峰度<0时，分布的峰态平缓（矮胖）；<br>
利用偏度和峰度进行正态性检验时，可以同时计算其相应的Z评分（Z-score），即：偏度Z-score=偏度值/标准误，峰度Z-score=峰度值/标准误。<br>
在α=0.05的检验水平下，若Z-score在±1.96之间，则可认为资料服从正态分布。<br>
了解偏度和峰度这两个统计量的含义很重要，在对数据进行正态转换时，需要将其作为参考，选择合适的转换方法。
- spss分析某人群BMI的分布特征<br>
方法一 选择Analyze(分析) → Descriptive Statistics(描述统计) → Frequencies(频率)
将BMI选入Variable(s)(变量)框中 → 点击Statistics (统计)→ 在Distribution(分布)框中勾选Skewness(偏度)和Kurtosis(峰度)<br>
![图](/img/1/2-3.jpg)<br>
方法二 
选择Analyze(分析) → Descriptive Statistics(描述统计) → Descriptives(描述)
将BMI选入Variable(s)(变量)框中 → 点击Options(选项) → 在Distribution(分布)框中勾选Skewness(偏度)和Kurtosis (峰度)<br>
![图](/img/1/2-4.jpg)<br>
- 正态性检验：直方图，表示连续性变量的频数分布，可以用来考察分布是否服从正态分布<br>
1) 选择Graphs(图形) → Legacy Diaiogs(旧对话框) → Histogram (直方图)<br>
2) 将BMI选入Variable(变量)中，勾选Display normal curve(显示正态曲线)绘制正态曲线 <br>
![图](/img/1/2-5.jpg)<br>
![图](/img/1/2-6.jpg)<br>
选择Analyze(分析) → Descriptive Statistics(描述统计) → P-P图（或Q-Q图）
P-P图反映了变量的实际累积概率与理论累积概率的符合程度，<br>
Q-Q图反映了变量的实际分布与理论分布的符合程度，两者意义相似，都可以用来考察数据资料是否服从某种分布类型。<br>
若数据服从正态分布，则数据点应与理论直线（即对角线）基本重合<br>
还可以直接使用Explore(探索)方法，结果中不仅可以输出偏度值，峰度值，绘制直方图，Q-Q图，还可以输出非参数检验的结果<br>
选择Analyze(分析) → Descriptive Statistics(描述统计) → Explore(探索)
将BMI选入Dependent List(因变量列表)中，点击Plots(图)，勾选Normality plots with tests(含检验的正态图)，在Descriptive(描述)框中勾选Histogram，Boxplots(直方图)选择None(无)，点击OK(确定)完成操作。<br>
![图](/img/1/2-7.jpg)<br>
### 二、T检验
### 1、单样本T检验
- 某研究者拟开展心理干预研究，招募了一批受试者。在实施该研究之前，他想了解这些受试者在抑郁分布方面是否具有代表性。因此，该研究者拟分析：受试者的抑郁评分均值与总体人群抑郁评分均值4.0是否存在统计学差异。
研究者收集了受试者的抑郁评分变量，部分数据如下：
![图](/img/1/2-8.jpg)<br>
研究者拟分析样本均值与总体均值的不同，即判断招募受试者的抑郁评分均值与总体抑郁评分均值4.0之间是否有差异。针对这种情况，我们可以使用单样本t检验<br>
下面用利用箱式图查找异常值的途径，SPSS输出箱式图
1) 在主页面点击Analyze(分析)→Descriptive Statistics(描述统计)→ Explore(探索)<br>
2) 将抑郁评分变量放入Dependent List(因变量列表)栏<br>
3) 点击Plots(图)<br>
4) 取消对Descriptive(描述)栏内 Stem-and-leaf(茎叶图)选项的选择，并点击Normality plots with tests(含检验的正态图)选项<br>
5) 点击Continue(继续), 点击Display(显示)栏的Plots(图)选项<br>
6) 点击OK(确定)<br>
![图](/img/1/2-9.jpg)<br>
![图](/img/1/2-10.jpg)<br>
一般来说，如果研究数据中存在显著的异常值，箱式图会以星号或者空心圆点的形式提示出来。如果数据值大于1.5倍箱距，数据的表示方式为空心圆点；如果数据值大于3倍箱距，数据的表示方式为星号。
- 案例应用：单样本T检验用于比较样本数据与一个特定数值之间是否的差异情况。<br>
例如，某公司使用五级李克量表问卷进行员工满意度调查，‘4分’代表满意，通过单样本t检验分析员工总体满意程度与“满意”（4）之间是否存在显著差异
### 2、独立样本T检验
- 独立T检验（也称T检验），要求因变量（y）需要符合正态分布性，如果不满足，此时可考虑使用非参数检验
- 案例应用：独立样本T检验用于分析定类数据（X）与定量数据（Y）之间的差异情况。<br>
独立样本T检验除了需要服从正态分布、还要求两组样本的总体方差相等。当数据不服从正态分布或方差不齐时，则考虑使用非参数检验。<br>
比较男生与女生的专业和职业任职得分的均值是否存在显著差异，可采用独立样本T检验进行分析。
### 3、配对样本的T检验
- 配对样本T检验，其默认前提条件是差值数据需要符合正态分布性，如果不满足，此时可考虑使用单样本Wilcoxon检验进行研究。<br>
其实配对样本T检验与单样本T检验的原理是一模一样，无非是进行了一次数据相减（即差值）处理而已，因而其和单样本T检验保持一致
- 案例应用：配对样本T检验用于分析配对定量数据之间的差异对比关系。与独立样本t检验相比，配对样本T检验要求样本是配对的。两个样本的样本量要相同；样本先后的顺序是一一对应的。<br>
例如，比较在两种背景情况下(有广告和无广告)；样本的购买意愿是否有着明显的差异性。通过两组数据的对比分析，判断背景音乐是否会影响消费行为<br>
![图](/img/1/2-12.jpg)<br>
### 三、卡方检验
### 1、卡方检验
- 和t检验一样，卡方检验也会用在成组和配对设计资料分析中。
- 用药物A治疗急性心肌梗死患者198例，24小时内死亡11例，病死率为5.56%，另42例治疗时采用药物B，24小时内死亡6例，病死率为14.29%，提问：两组病死率有无差别？
- 选择Analyze(分析)→Descriptive Statistics(描述统计)→Crosstabs(交叉表)<br>
1) 主对话框设置：将分组变量药物放入Row(s)(行)框中→将指标变量转归放入Column(s)(列)框中（实际上χ2检验是关注实际和理论频数是否一致，这里Row(s)(行)框和Column(s)(列)框内变量也可以颠倒放，并不影响最终结果）。<br>
2) Statistics(统计)设置：勾选Chi-square(卡方)，确定使用成组计数资料的卡方检验→Continue(继续)<br>
3) Cells(单元格)设置：Counts(计数)中勾选Observed(实例)和Expected(期望)，输出实际观测频数和理论频数；Percentages(百分比)中勾选Row(行)，输出每组转归百分比→Continue(继续)→OK(确定)<br>
![图](/img/1/2-11.jpg)<br>
### 2、Fisher精确检验
- Fisher确切概率法是一种直接计算概率的假设检验方法，当四格表资料的样本量n＜40或四个格子中至少存在一个格子的频数T＜1时，需要用四格表资料的Fisher确切概率（Fisher probabilities in 2×2 table data）法
- 依次点击“分析——描述统计——交叉表格”
- 在“交叉表格”窗口中，将“组别”属性选入行中，“有效性”属性选入列中，并点击“精确”
- 在“交叉表格”窗口中，点击“统计”，在出现的“统计”窗口中，勾选“卡方”<br>
![图](/img/1/2-13.jpg)<br>
### 3、配对卡方检验
- 配对卡方检验, 适用于对同一人群先后使用两种检测方法，计算的是两种诊断试验不一致的部分（比如表1的b和c）
### 4、OR值计算
-OR值又称比值比、优势比，主要指病例组中暴露人数与非暴露人数的比值除以对照组中暴露人数与非暴露人数的比值，是流行病学研究中病例对照研究中的一个常用指标
### 5、RR值计算
- RR值，称为相对危险度，或者危险比，实质就是两个率的比，是两组真实发病率、患病率或死亡率的比值
### 6、分层卡方检验
- 分层卡方检验，也称为CMH检验，它主要用于上述的分层分析中，也就是在研究暴露/处理因素和结局事件关联性的基础上，考虑了分层因素的混杂作用
- 操作： Analyze(分析)→Descriptive Statistics(描述统计)→Crosstabs(交叉表)
### 四、方差分析
### 1、单因素方差分析
- 分析中要考察的指标称为分析指标，影响分析指标的条件称为因素，因素所处的状态称为水平，若分析中只有一个因素改变则称为单因素分析
### 2、双因素方差分析
- 若有两个因素改变则称为双因素
### 3、多因素方差分析
- 若有多个因素改变则称为多因素分析
- 方差分析操作： Analyze(分析)→General Linear Model(一般线性模型)→Univariate(单变量)
![图](/img/1/2-14.jpg)<br>
### 五、回归
### 1、二分类Logistic回归
- 二分类变量称为0-1变量。列如，性别（男，女），疾病（有，无）等
### 2、有序多分类Logistic回归
- 有序多分类的Logistic回归模型中，必须对自变量系数相等的假设进行检验（又称平行线检验）。如果不满足平行线假设，则考虑使用无序多分类Logistic回归或其他统计方法
### 3、无序多分类Logistic回归
- 无序多分类logistic回归用于因变量为无序多分类的情况，如不同病理类型的患者（腺癌、鳞癌、腺鳞癌）；也可用于因变量为有序多分类的情况，但因变量不是严格意义的有序时
### 4、简单线性回归
- 简单线性回归包含一个自变量(x)和一个因变量(y)，两个变量的关系用一条直线来模拟
### 5、多重线性回归
- 如果包含两个以上的自变量，则称作多元回归分析(multiple regression)
- 回归分析操作： Analyze(分析)→regression(回归)→binary logistic(二元回归)
![图](/img/1/2-15.jpg)<br>

